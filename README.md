# ğŸ§˜ Há»† THá»NG NHáº¬N Dáº NG & ÄÃNH GIÃ TÆ¯ THáº¾ YOGA

> **Äá»“ Ã¡n cuá»‘i ká»³ mÃ´n Xá»­ lÃ½ áº£nh sá»‘**  
> á»¨ng dá»¥ng YOLOv8, Machine Learning vÃ  Geometric Analysis  
> **NHÃ“M 18 - HCMUTE**

---

## ğŸ‘¥ **THÃ”NG TIN NHÃ“M**

**TrÆ°á»ng:** Äáº¡i há»c SÆ° pháº¡m Ká»¹ thuáº­t TP.HCM (HCMUTE)  
**MÃ´n:** Xá»­ lÃ½ áº£nh sá»‘  
**NhÃ³m:** 18

**ThÃ nh viÃªn:**
1. **Mai Há»“ng Háº£i** - MSSV: 22133014
2. **Nguyá»…n Táº¥n HÃ¹ng** - MSSV: 22133027
3. **Nguyá»…n Ngá»c Hiáº¿u Háº£o** - MSSV: 22133015

---

## ğŸ¯ **Má»¤C TIÃŠU**

XÃ¢y dá»±ng há»‡ thá»‘ng:
1. **Nháº­n dáº¡ng** tÆ° tháº¿ Yoga tá»« áº£nh/video
2. **Cháº¥m Ä‘iá»ƒm** Ä‘á»™ chÃ­nh xÃ¡c (0-100) vá»›i nhiá»u tiÃªu chÃ­
3. **Feedback** chi tiáº¿t vá» tÆ° tháº¿ (tiáº¿ng Viá»‡t)

**5 TÆ° tháº¿:**
- ğŸ§˜ **Plank** - Chá»‘ng Ä‘áº©y (Straight-arm & Elbow variants)
- ğŸŒ³ **Tree** - CÃ¡i cÃ¢y
- âš”ï¸ **Warrior II** - Chiáº¿n binh 2
- ğŸ‘¸ **Goddess** - Ná»¯ tháº§n
- ğŸ• **Downward Dog** - ChÃ³ Ãºp máº·t

---

## âœ¨ **TÃNH NÄ‚NG Ná»”I Báº¬T**

### **ğŸš€ Performance**
- âœ… **GPU Acceleration** - YOLOv8 trÃªn CUDA (NVIDIA RTX)
- âœ… **Async Video Processing** - Producer-Consumer architecture
- âœ… **Real-time FPS** - 30 FPS video playback mÆ°á»£t mÃ 

### **ğŸ¯ Accuracy**
- âœ… **Hybrid AI + Geometry** - ML classifier vá»›i geometric override rules
- âœ… **Multi-Criteria Evaluation** - 2-3 tiÃªu chÃ­ má»—i tÆ° tháº¿
- âœ… **Y-Position Checks** - PhÃ¡t hiá»‡n chÃ­nh xÃ¡c vá»‹ trÃ­ tay/chÃ¢n
- âœ… **Wrist Distance Check** - Kiá»ƒm tra tay cÃ³ cháº¯p láº¡i khÃ´ng
- âœ… **Relaxed Thresholds** - Cháº¥p nháº­n variance cá»§a keypoint detection

### **ğŸ’» User Experience**
- âœ… **Desktop GUI** - Giao diá»‡n Ä‘áº¹p vá»›i CustomTkinter
- âœ… **Dark/Light Mode** - Chuyá»ƒn Ä‘á»•i giao diá»‡n
- âœ… **Keyboard Shortcuts** - Space (pause), S (snapshot)
- âœ… **Vietnamese Feedback** - Pháº£n há»“i chi tiáº¿t báº±ng tiáº¿ng Viá»‡t
- âœ… **Save Results** - LÆ°u áº£nh káº¿t quáº£ vÃ  snapshots

---

## ğŸ—ï¸ **KIáº¾N TRÃšC**

### **Hybrid: ML + Geometric Analysis**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Image/Video  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   YOLOv8    â”‚  ğŸš€ GPU-Accelerated
â”‚ 17 Keypointsâ”‚  Deep Learning
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚              â”‚             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ML Classifierâ”‚ â”‚  Geometry  â”‚    â”‚
â”‚  "Plank"    â”‚ â”‚  Override  â”‚    â”‚
â”‚   90% conf  â”‚ â”‚  Fix errorsâ”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
       â”‚              â”‚            â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
              â”‚                    â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
       â”‚  Evaluator    â”‚           â”‚
       â”‚ Multi-Criteriaâ”‚           â”‚
       â”‚  Score: 85    â”‚           â”‚
       â”‚  "Hip highâš ï¸" â”‚           â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
              â”‚                    â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”
       â”‚    Visualization            â”‚
       â”‚ Skeleton + Score + Feedback â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ **Cáº¤U TRÃšC**

```
src/
â”œâ”€â”€ detection/          # 1ï¸âƒ£ YOLOv8 Pose Detection (GPU)
â”‚   â”œâ”€â”€ pose_detector.py
â”‚   â””â”€â”€ keypoint_constants.py
â”‚
â”œâ”€â”€ recognition/        # 2ï¸âƒ£ Hybrid ML + Geometric
â”‚   â”œâ”€â”€ ml_classifier.py      â†’ Neural Network
â”‚   â””â”€â”€ pose_recognizer.py    â†’ AI + Override rules
â”‚
â”œâ”€â”€ geometry/          # 3ï¸âƒ£ Geometric Analysis
â”‚   â””â”€â”€ geometry_utils.py     â†’ Angles, distances
â”‚
â”œâ”€â”€ evaluation/        # 4ï¸âƒ£ Multi-Criteria Scoring
â”‚   â””â”€â”€ pose_evaluator.py     â†’ Detailed scoring
â”‚
â”œâ”€â”€ visualization/     # 5ï¸âƒ£ Visualization
â”‚   â”œâ”€â”€ skeleton_drawer.py    â†’ Color-coded skeleton
â”‚   â””â”€â”€ overlay_ui.py         â†’ Score overlay
â”‚
â””â”€â”€ config/
    â””â”€â”€ app_config.py

models/
â””â”€â”€ pose_classification.pth   # Trained ML model

datasets/
â””â”€â”€ yoga_pose_keypoint.csv    # 1000+ samples

docs/
â””â”€â”€ pose_requirements.md      # Pose specs & thresholds
```

---

## ğŸ› ï¸ **CÃ”NG NGHá»†**

| Component | Technology | Details |
|-----------|-----------|---------|
| **Pose Detection** | YOLOv8 Pose | GPU-accelerated (CUDA) |
| **Classification** | PyTorch Neural Network | 90%+ accuracy |
| **Geometric Analysis** | NumPy | Angle & distance calculations |
| **Scoring** | Multi-criteria rules | 2-3 checks per pose |
| **Visualization** | OpenCV + PIL | Color-coded skeleton |
| **GUI** | CustomTkinter | Modern desktop UI |
| **Video Processing** | Threading + Queue | Async producer-consumer |
| **Language** | Python 3.12+ | Type hints, modern syntax |

---

## ğŸ”¬ **PHÆ¯Æ NG PHÃP**

### **1. YOLOv8 Pose Detection (GPU)**
- Model: `yolov8m-pose.pt`
- Output: 17 COCO keypoints
- **GPU**: 10x faster than CPU
- Normalized & absolute coordinates

### **2. Hybrid ML + Geometric**
```python
# ML Classification (Primary)
pose, conf = neural_network.predict(keypoints)

# Geometric Overrides (Fix ML errors)
if pose == 'Goddess' and shoulder_y > hip_y:
    pose = 'Unknown'  # Bent over detection
    
if pose == 'Downdog' and hip_angle > 140Â°:
    pose = 'Plank'  # Fix common confusion
```

### **3. Multi-Criteria Scoring**
**VÃ­ dá»¥: Plank**
- **Body angle** (60%):
  - 160-175Â°: Score 100 âœ…
  - 150-160Â°: Score 85 âš ï¸
  - <150Â°: Score 70 âŒ
- **Arms** (40%):
  - Supporting + straight: Score 100 âœ…
  - Supporting + bent: Score 75 âš ï¸
  - Not supporting: Score 30 âŒ

### **4. Advanced Checks**
- **Y-Position**: Wrist pháº£i CAO HÆ N shoulder (Goddess)
- **Distance**: 2 wrists pháº£i Gáº¦N NHAU (Tree)
- **Supporting**: Elbow/Wrist pháº£i tháº¥p hÆ¡n shoulder (Plank)

---

## ğŸš€ **Sá»¬ Dá»¤NG**

### **CÃ i Ä‘áº·t**
```bash
# Clone repository
git clone https://github.com/your-repo/human-action-detector.git
cd human-action-detector

# Create virtual environment
python3 -m venv .venv
source .venv/bin/activate  # Linux/Mac
# .venv\Scripts\activate  # Windows

# Install dependencies
pip install -r requirements.txt
```

### **Cháº¡y GUI (Khuyáº¿n nghá»‹)**
```bash
python app_ui.py
```

**TÃ­nh nÄƒng GUI:**
- ğŸ“· **Image Mode** - PhÃ¢n tÃ­ch áº£nh
- ğŸ¥ **Video Mode** - PhÃ¢n tÃ­ch video (async processing)
- â¸ï¸ **Pause/Resume** - Space bar
- ğŸ“¸ **Snapshot** - S key (lÆ°u frame khi video)
- ğŸ’¾ **Save Results** - LÆ°u áº£nh káº¿t quáº£
- ğŸŒ“ **Dark/Light Mode** - Chuyá»ƒn Ä‘á»•i theme

### **Cháº¡y CLI (Optional)**
```bash
# Xá»­ lÃ½ áº£nh
python src/main.py --input images/plank.jpg

# Xá»­ lÃ½ video
python src/main.py --input videos/yoga.mp4 --output results/yoga_result.mp4
```

---

## ğŸ“Š **Káº¾T QUáº¢**

### **Output Example:**
```
Pose: Plank
Score: 85/100
Feedback: "Tá»‘t! Cáº§n Ä‘iá»u chá»‰nh: hÃ´ng hÆ¡i cao âš ï¸"
Details:
  - Body angle: 165Â° (target: 160-175Â°)
  - Arms: Straight & supporting âœ…
```

### **Accuracy:**
- âœ… **ML Classification**: 90%+ accuracy
- âœ… **Geometric Overrides**: Fixed 15%+ systematic errors
- âœ… **Multi-Criteria Scoring**: Realistic 0-100 scores
- âœ… **Vietnamese Feedback**: Actionable suggestions

---

## ğŸ“ **ÄIá»‚M Ná»”I Báº¬T**

### **Technical Excellence:**
âœ… **GPU Acceleration** - YOLOv8 CUDA  
âœ… **Hybrid Architecture** - ML + Geometric rules  
âœ… **Async Processing** - Smooth 30 FPS video  
âœ… **Y-Position Checks** - Advanced geometric analysis  
âœ… **Multi-Criteria Evaluation** - Weighted scoring  

### **Academic Value:**
âœ… **Deep Learning Application** - YOLOv8 Pose  
âœ… **Computer Vision** - Keypoint detection  
âœ… **Geometric Calculations** - Angle & distance analysis  
âœ… **Real-world Problem** - Yoga pose correction  
âœ… **Production Quality** - GUI, error handling, async  

### **Innovation:**
âœ… **Hybrid AI + Geometry** - Best of both worlds  
âœ… **Geometric Overrides** - Fix ML without retraining  
âœ… **Vietnamese Feedback** - Localized, actionable  
âœ… **Multi-Variant Support** - Plank (straight-arm & elbow)  

---

## ğŸ“š **DATASET**

- **Source**: Yoga Pose Classification (Kaggle)
- **Size**: 1000+ labeled samples
- **Format**: CSV with normalized keypoint coordinates
- **Classes**: 5 poses (balanced distribution)
- **Augmentation**: Applied during training

---

## ï¿½ **YÃŠU Cáº¦U Há»† THá»NG**

### **Minimum:**
- Python 3.8+
- 4GB RAM
- CPU: Multi-core

### **Recommended:**
- Python 3.12+
- 8GB+ RAM
- **GPU: NVIDIA with CUDA** (10x faster!)
- SSD storage

---

## ğŸ“– **TÃ€I LIá»†U THAM KHáº¢O**

1. **YOLOv8 Pose Documentation** - Ultralytics
2. **COCO Keypoints Specification** - COCO Dataset
3. **Yoga Pose Analysis** - Various yoga resources
4. **CustomTkinter** - Modern GUI framework
5. **PyTorch** - Deep learning framework

---

## ğŸ“ **DOCUMENTATION**

- `README.md` - This file (overview, setup, usage)
- `PROJECT_STRUCTURE.md` - Architecture & design decisions
- `docs/pose_requirements.md` - Pose specifications & thresholds

---

## ğŸ™ **CREDITS**

**Developed by:** NHÃ“M 18 - HCMUTE  
**Course:** Xá»­ lÃ½ áº£nh sá»‘  
**Instructor:** [TÃªn Giáº£ng ViÃªn]  
**Institution:** Äáº¡i há»c SÆ° pháº¡m Ká»¹ thuáº­t TP.HCM

**Technologies:**
- YOLOv8 (Ultralytics)
- PyTorch
- OpenCV
- CustomTkinter
- NumPy

---

**ğŸš€ Made with Python, Deep Learning & Geometric Analysis**

**Last Updated:** 2025-12-21 - Production-ready with advanced features
